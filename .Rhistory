x <- bp / 1e6
x <- format(round(x, 2), nsmall = 2)
x <- paste0(x, " Mb")
return(x)
}
assembly_qc_value$genome_size <- bp_to_mb(assembly_qc_value$genome_size)
assembly_qc_value$sample_id <- gsub("_", "\\_", assembly_qc_value$sample_id, fixed = TRUE)
# Rename and reorder columns
colnames(assembly_qc_value) <- c("Isolate No.","Sample ID", "WGS ID", "Completeness", "Contamination", "Total Coding Sequences",
"Genome Size", "GC Content", "N50", "Total Contig", "Raw Reads Result", "Assembly Result")
for (i in 1:nrow(assembly_qc_result)) {
if (!is.na(assembly_qc_result$failed_idx[i]) && nzchar(assembly_qc_result$failed_idx[i])) {
# Split and convert to numeric safely
indices <- tryCatch({
as.numeric(trimws(unlist(strsplit(assembly_qc_result$failed_idx[i], ","))))
}, error = function(e) numeric(0))
# Remove any NAs from conversion
indices <- indices[!is.na(indices) & indices > 0]
# Apply formatting to each specified column
for (col in indices) {
# Adjust column index (now accounts for renamed columns)
display_col <- col
#display_col <- col + 3  # Adjust based on your column structure
if (display_col <= ncol(assembly_qc_value)) {
# Convert all columns to character (or only numeric ones)
assembly_qc_value[] <- lapply(assembly_qc_value, as.character)
# Get original value
original_value <- assembly_qc_value[i, display_col]  # Adjust offset as needed
# Apply LaTeX formatting for PDF
assembly_qc_value[i, display_col] <- as.character(paste0("\\colorbox{myred}{\\textcolor{white}{\\textbf{", original_value, "}}}")
)
}
}
}
}
# Change Assembly Result based on Raw Reads Result
assembly_qc_value <- assembly_qc_value %>%
mutate(`Assembly Result` = ifelse(`Raw Reads Result` == 'FAILED', "FAILED", `Assembly Result`))
# Get row indices
rows_passed_raw <- which(assembly_qc_value$`Raw Reads Result`== 'PASSED')
rows_warning_raw <- which(assembly_qc_value$`Raw Reads Result` == 'WARNING')
rows_failed_raw <- which(assembly_qc_value$`Raw Reads Result` == 'FAILED')
rows_passed_asm <- which(assembly_qc_value$`Assembly Result`== 'PASSED')
rows_warning_asm <- which(assembly_qc_value$`Assembly Result` == 'WARNING')
rows_failed_asm <- which(assembly_qc_value$`Assembly Result` == 'FAILED')
assembly_qc_value <- assembly_qc_value %>%
mutate(
`Raw Reads Result` = case_when(
row_number() %in% rows_passed_raw   ~ cell_spec(`Raw Reads Result`, background = "#006b54", color = "white"),
row_number() %in% rows_warning_raw  ~ cell_spec(`Raw Reads Result`, background = "#ffd858"),
row_number() %in% rows_failed_raw   ~ cell_spec(`Raw Reads Result`, background = "#D2042D", color = "white"),
TRUE ~ `Raw Reads Result`
)
) %>%
mutate(
`Assembly Result` = case_when(
row_number() %in% rows_passed_asm   ~ cell_spec(`Assembly Result`, background = "#006b54", color = "white"),
row_number() %in% rows_warning_asm  ~ cell_spec(`Assembly Result`, background = "#ffd858"),
row_number() %in% rows_failed_asm   ~ cell_spec(`Assembly Result`, background = "#D2042D", color = "white"),
TRUE ~ `Assembly Result`
)
)
# --- Generate formatted table ---
# Create the table
assembly_qc_value %>%
kable(format = "latex", booktabs = TRUE, escape = FALSE, align = "c", row.names = FALSE) %>%
kable_styling(latex_options = c("scale_down", "hold_position")) %>%
row_spec(0, background = "#D4D4D4",bold = TRUE) %>%
column_spec(3,italic = TRUE) %>%
footnote(general = c("\\\\colorbox{mygreen}{\\\\textcolor{white}{PASSED}}","  |  ",
"\\\\colorbox{myyellow}{WARNING}","  |  ",
"\\\\colorbox{myred}{\\\\textcolor{white}{FAILED}}"),
general_title = "Legend:",
footnote_as_chunk = T, escape = F)
assembly_failed <- assembly_qc_checked %>% filter(!is.na(failed_conditions))
if (nrow(assembly_failed) !=0) {
assembly_reco_df <- assembly_failed %>% select(sample_id, failed_conditions) %>%
mutate(failed_conditions = paste(unique(failed_conditions), collapse = ", ")) %>%
mutate(sample_id = sub("(.*)_[^_]*$", "\\1", sample_id))
} else {
sample_id <- ""
failed_conditions <- "No further action required for this batch."
assembly_reco_df <- data.frame(sample_id,failed_conditions, remarks)
}
colnames(assembly_reco_df) <- c('Sample ID','Reason - Failed Metrics')
assembly_reco_table <- assembly_reco_df %>%
kable(
format = "latex",
booktabs = TRUE,
escape = TRUE,  # Keep FALSE since you pre-escaped underscores
align = c("l", "c", "c")
) %>%
kable_styling(
position = "left",
latex_options = c("striped", "hold_position")
) %>%
column_spec(1, width = "6cm") %>%
column_spec(2, width = "6cm") %>%
row_spec(0, background = "#D4D4D4", bold = TRUE) %>%
add_header_above(c("Summary of Assembly Reads with FAILED QC results" = 2), align = "l", bold = TRUE)
assembly_reco_table
overall_reco <- assembly_qc_checked %>%
filter(raw_reads_result == "FAILED" | assembly_result == "FAILED") %>%
select(sample_id, raw_reads_result, assembly_result) %>%
mutate(sample_id = sub("(.*)_[^_]*$", "\\1", sample_id)) %>%
group_by(raw_reads_result, assembly_result) %>%
summarize(sample_id = paste0(sample_id, collapse = ", "))
# Generate Final Result
overall_reco <- overall_reco %>%
mutate(final_result = case_when(
raw_reads_result == "PASSED" & assembly_result == "PASSED" ~ "PASSED",
raw_reads_result == "FAILED" | assembly_result == "FAILED" ~ "FAILED",
.default = ""
))
if (nrow(overall_reco) !=0) {
overall_reco_df <- overall_reco %>%
relocate(sample_id, .before = raw_reads_result)
colnames(overall_reco_df) <- c("Sample ID", "Raw Reads Result", "Assembly Result", "Final Result")
overall_reco_table <- overall_reco_df %>%
kable(
format = "latex",
booktabs = TRUE,
escape = TRUE,  # Keep FALSE since you pre-escaped underscores
align = c("l", "c", "c")
) %>%
kable_styling(
position = "left",
latex_options = c("striped", "hold_position")
) %>%
column_spec(1, width = "8cm") %>%
column_spec(2:4, width = "3cm") %>%
row_spec(0, background = "#D4D4D4", bold = TRUE)
overall_reco_table
} else {
sample_id <- ""
remarks <- "No further action required for this batch."
overall_reco_df <- data.frame(sample_id,remarks)
colnames(overall_reco_df) <- c("Sample ID", "Remarks")
overall_reco_table <- overall_reco_df %>%
kable(
format = "latex",
booktabs = TRUE,
escape = TRUE,  # Keep FALSE since you pre-escaped underscores
align = c("l", "c", "c")
) %>%
kable_styling(
position = "left",
latex_options = c("striped", "hold_position")
) %>%
column_spec(1, width = "6cm") %>%
column_spec(2, width = "6cm") %>%
row_spec(0, background = "#D4D4D4", bold = TRUE)
overall_reco_table
}
raw_reads_summary <- bactscout_df_value %>%
select(-a_final_status, -species)
# Get raw reads failed result from bactscout_df_result
raw_reads_summary$failed_conditions <- bactscout_df_result$failed_cols[bactscout_df_result$name == raw_reads_summary$sample_id]
# create new wgs_summary_table with additional column for result
raw_reads_summary <- raw_reads_summary %>%
mutate(
batch_code = batch_code,
sample_id = sub("(.*)_[^_]*$", "\\1", sample_id)
) %>%
relocate(batch_code, .before = sample_id)
overall_result <- merge(raw_reads_summary, assembly_qc_summary, by ="sample_id")
overall_result <- overall_result %>%
mutate(final_result = case_when(
raw_reads_result == "PASSED" & assembly_result == "PASSED" ~ "PASSED",
raw_reads_result == "WARNING" & assembly_result == "PASSED" ~ "PASSED",
raw_reads_result == "FAILED" | assembly_result == "FAILED" ~ "FAILED",
.default = ""
)) %>%
relocate(wgs_id, .before = species_abundance) %>%
relocate(final_result, .after = wgs_id)
#sheet_write(data = overall_result, ss = sheet_id, sheet = "result")
# append googlesheet "result" tab
sheet_append(ss = sheet_id, sheet = "result", data = overall_result)
View(df_mlst)
#rename columns
mlst_df_clean <- df_mlst %>%
rename("sample_id" = 1,
"species" = 2,
"MLST" = 3
) %>%
mutate(
sample_id = sub(".*/(.*)\\.fna$", "\\1", sample_id),
sample_id = gsub("-", "_", sample_id)
) %>%
filter(str_detect(sample_id, batch_name_clean))
View(mlst_df_clean)
View(wgs_df)
#rename columns
mlst_df_clean <- df_mlst %>%
rename("sample_id" = 1,
"species" = 2,
"MLST" = 3
) %>%
mutate(
sample_id = sub(".fna$", "\\1", sample_id),
sample_id = gsub("-", "_", sample_id)
) %>%
filter(str_detect(sample_id, batch_name_clean))
# Split the string in each row by a semicolon
split_list <- strsplit(mlst_df_clean$ALLELES, split = ";")
View(split_list)
# Determine the maximum number of values across all rows
max_cols <- max(sapply(split_list, length))
# Pad shorter lists with NA to make them all the same length
split_list_padded <- lapply(split_list, function(x) {
length(x) <- max_cols
return(x)
})
# Convert the list to a matrix and then to a data frame, assigning names
new_cols_df <- as.data.frame(do.call(rbind, split_list_padded))
colnames(new_cols_df) <- paste0("allele", 1:max_cols)
View(new_cols_df)
mlst_df_clean <- cbind(mlst_df_clean, new_cols_df)
#drop row without species
mlst_df_clean <- subset(mlst_df_clean, mlst_df_clean$species != '-')
#merge wgs_id from wgs_df to mlst_df to set as species value
wgs_species <- subset(wgs_df, select = c("sample_id", "wgs_id"))
mlst_df_clean <- merge(mlst_df_clean,wgs_species,by = "sample_id")
#remove batch name in sample_id
mlst_df_clean$sample_id <- sub("(.*)_[^_]*$", "\\1", mlst_df_clean$sample_id)
#reorder column
mlst_df_clean <- mlst_df_clean %>%
relocate(wgs_id, .after = species)
#identify salmonella enterica group
mlst_df_clean$species <- ifelse(mlst_df_clean$wgs_id == 'Salmonella enterica', 'salmonella_enterica', ifelse(mlst_df_clean$wgs_id == 'Salmonella typhoidal','salmonella_typhoidal', mlst_df_clean$species))
#not identified sample
#mlst_df_clean[is.na(mlst_df_clean)] <- 'Not Identified'
#list unique species in the dataframe
species_list <- unique(mlst_df_clean$species)
#list unique wgs_id in the dataframe
mlst_organism_list <- unique(mlst_df_clean$wgs_id)
# -- add letter --
mlst_organism_list <- paste0(
letters[seq_along(mlst_organism_list)],
") ",
mlst_organism_list
)
# -- Add "and" before the last item --
n <- length(mlst_organism_list)
mlst_organism_list[n] <- paste("and", mlst_organism_list[n])
mlst_df_list = c()
mlst_df_clean <- mlst_df_clean %>%
relocate(wgs_id, .after = species) %>%
select(-ALLELES)
#create multiple dataframe for each species
for(i in species_list) {
#retain first four columns
mlst_info_df <- subset(mlst_df_clean, select = 1:6)
#remove demogs column
mlst_result_df <- subset(mlst_df_clean, , select = -c(1:6))
#use first row data as column names in r
colnames(mlst_result_df)=mlst_result_df[c(1),]
#remove special characters and number from column header
colnames(mlst_result_df) <- gsub("\\s*\\(.*", "", colnames(mlst_result_df))
# Apply gsub to get text inside the parenthesis
mlst_result_df <- apply(mlst_result_df, 2, function(x) gsub("\\(([^()]*)\\)|.", "\\1", x, perl=T))
#remove rows with na value
mlst_result_df <- mlst_result_df[ , colSums(is.na(mlst_result_df))==0]
# Convert back to data frame
mlst_result_df <- as.data.frame(mlst_result_df)
#combine the two dataframe
mlst_result_df <- cbind(mlst_info_df,mlst_result_df)
#assign new name to dataframe
nam <- paste("df", i, sep = "_")
assign(nam, mlst_result_df[mlst_result_df$species==i,])
mlst_df_list <- c(mlst_df_list, nam)
}
View(df_ecoli_achtman_4)
#list existing sample_id in the mlst table
not_included <- wgs_df$wgs_id[!(wgs_df$wgs_id %in% mlst_df_clean$wgs_id)]
for(i in mlst_df_list) {
df <- get(i)
df <- subset(df, select = -c(species) )
names(df)[names(df) == 'wgs_id'] <- 'species'
names(df)[names(df) == 'sample_id'] <- 'Sample ID'
col_num <- ncol(df)
#kable(df,  "latex", booktabs = T, align = "c") %>%
#kable_styling(position = "left") %>%
#row_spec(0, background = "#D4D4D4",bold = TRUE)
mlst_table <- kable(df, format='latex', booktabs = TRUE, align = "c", row.names = FALSE) %>%
kable_styling(latex_options = c("hold_position","scale_down"), position = "left") %>%
row_spec(0, background = "#D4D4D4",bold = TRUE)%>%
column_spec(1, width = "3cm") %>%
column_spec(2, width = "3cm", italic = TRUE) %>%
column_spec(3:col_num, width = "1cm") %>%
footnote(general ="(-) Not identified",
general_title = "Legend: ",
footnote_as_chunk = T, title_format = c("italic"))
print(mlst_table)
}
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_html.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '_html.html', sep='')
)
}
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_ver2.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '.pdf', sep='')
)
}else{
cat("No file found")
}
View(bactscout_df_result)
View(bactscout_df_value)
bactscout_df_result <- df_bactscout_mod %>%
select(name, species, Contamination = contamination_message,`Coverage (Qualibact)` = coverage_estimate_qualibact_status, `Duplication Rate` = duplication_status,
`GC Content` = gc_content_status, `MLST (ST)` = mlst_status, `Read Length` = read_length_status, `Read Q30` = read_q30_status, a_final_status)
bactscout_df_result <- df_bactscout_mod %>%
select(name, species, Contamination = contamination_message,`Coverage (Qualibact)` = coverage_estimate_qualibact_status, `Duplication Rate` = duplication_status,
`GC Content` = gc_content_status, `MLST (ST)` = mlst_status, `Read Length` = read_length_status, `Read Q30` = read_q30_status, a_final_status) %>%
mutate(Contamination = ifelse(Contamination != "OK", "PASSED", "FAILED"))
# --- Create new column to check final status with warning status and list column indices with failed results ---
bactscout_df_result <- df_bactscout_mod %>%
select(name, species, Contamination = contamination_message,`Coverage (Qualibact)` = coverage_estimate_qualibact_status, `Duplication Rate` = duplication_status,
`GC Content` = gc_content_status, `MLST (ST)` = mlst_status, `Read Length` = read_length_status, `Read Q30` = read_q30_status, a_final_status) %>%
mutate(Contamination = ifelse(Contamination != "OK", "PASSED", "FAILED"))
bactscout_df_result$Contamination <- ifelse()
# --- Create new column to check final status with warning status and list column indices with failed results ---
bactscout_df_result <- df_bactscout_mod %>%
select(name, species, Contamination = contamination_message,`Coverage (Qualibact)` = coverage_estimate_qualibact_status, `Duplication Rate` = duplication_status,
`GC Content` = gc_content_status, `MLST (ST)` = mlst_status, `Read Length` = read_length_status, `Read Q30` = read_q30_status, a_final_status) %>%
mutate(Contamination = ifelse(Contamination != "OK", "PASSED", "FAILED"))
bactscout_df_result$failed_idx <- apply(bactscout_df_result, 1, function(row) {
if (row["a_final_status"] == "FAILED") {
# Get indices of columns with FAILED
failed_cols <- which(row[-c(1,2,10)] == "FAILED") # exclude name and species
# Adjust index to match original dataframe
failed_cols <- failed_cols + 3
paste(failed_cols, collapse = ", ")
} else {
""
}
})
bactscout_df_result$failed_cols <- apply(bactscout_df_result, 1, function(row) {
if (row["a_final_status"] == "FAILED") {
warning_cols <- names(row)[which(row[-c(1,2,10)] == "FAILED") + 2] # adjust for original df
if (length(warning_cols) == 0) {
""
} else {
paste(warning_cols, collapse = ", ")
}
} else {
""
}
})
# --- List sample without bactscout result ---
no_bactscout_result <- setdiff(sample_name, df_bactscout_mod$name)
# --- remove text after last underscore ---
no_bactscout_result <- sub("_[^_]*$", "", no_bactscout_result)
# --- Modify dataframe ---
bactscout_df_value <- df_bactscout_mod %>%
select(name, species, species_abundance, coverage_estimate_qualibact, duplication_rate,
gc_content, mlst_st, read1_mean_length, read2_mean_length, read_q30_rate, a_final_status) %>%
rename(sample_id = name) %>%
mutate(read_length = paste0(read1_mean_length, " - ", read2_mean_length)) %>%
select(-read1_mean_length, -read2_mean_length) %>%
relocate(read_length, .before = "read_q30_rate")
# Change MLST ST column NUll value to Blank
bactscout_df_value$mlst_st <- lapply(bactscout_df_value$mlst_st, function(x) {
if (is.null(x)) "" else x
})
# --- Get Isolate number by merging ---
bactscout_df_merge <- merge(bactscout_df_value, arsrl_id_df, by ="sample_id")
# --- Modify dataframe ---
bactscout_df_merge <- bactscout_df_merge %>%
mutate(sample_id = sub("(.*)_[^_]*$", "\\1", sample_id)) %>%
select(-arsrl_org) %>%
relocate(iso_num, .before = "sample_id")
bactscout_df_merge$sample_id <- gsub("_", "\\_", bactscout_df_merge$sample_id, fixed = TRUE)
# Rename and reorder columns
colnames(bactscout_df_merge) <- c("Isolate No.","Sample ID", "Species", "Species Abundance", "Coverage (Qualibact)", "Duplication Rate",
"GC Content", "MLST (ST)", "Read Length", "Read Q30", "Final Status")
for (i in 1:nrow(bactscout_df_result)) {
if (!is.na(bactscout_df_result$failed_idx[i]) && nzchar(bactscout_df_result$failed_idx[i])) {
# Split and convert to numeric safely
indices <- tryCatch({
as.numeric(trimws(unlist(strsplit(bactscout_df_result$failed_idx[i], ","))))
}, error = function(e) numeric(0))
# Remove any NAs from conversion
indices <- indices[!is.na(indices) & indices > 0]
# Apply formatting to each specified column
for (col in indices) {
# Adjust column index (now accounts for renamed columns)
display_col <- col
#display_col <- col + 3  # Adjust based on your column structure
if (display_col <= ncol(bactscout_df_merge)) {
# Get original value
original_value <- bactscout_df_merge[i, display_col]  # Adjust offset as needed
# Apply LaTeX formatting for PDF
bactscout_df_merge[i, display_col] <- paste0("\\colorbox{myred}{\\textcolor{white}{\\textbf{",as.character(original_value),"}}}")
}
}
}
}
# Get row indices
rows_passed <- which(bactscout_df_result$a_final_status == 'PASSED')
rows_warning <- which(bactscout_df_result$a_final_status == 'WARNING')
rows_failed <- which(bactscout_df_result$a_final_status == 'FAILED')
bactscout_df_merge <- bactscout_df_merge %>%
mutate(
`Final Status` = case_when(
row_number() %in% rows_passed  ~ cell_spec(`Final Status`, background = "#006b54", color = "white"),
row_number() %in% rows_warning ~ cell_spec(`Final Status`, background = "#ffd858"),
row_number() %in% rows_failed  ~ cell_spec(`Final Status`, background = "#D2042D", color = "white"),
TRUE ~ `Final Status`
)
)
# --- Generate formatted table ---
# Create the table
bactscout_df_merge %>%
kable(format = "latex", booktabs = TRUE, escape = FALSE, align = "c", row.names = FALSE) %>%
kable_styling(latex_options = c("scale_down", "hold_position")) %>%
row_spec(0, background = "#D4D4D4",bold = TRUE) %>%
column_spec(3,italic = TRUE) %>%
footnote(general = c("\\\\colorbox{mygreen}{\\\\textcolor{white}{PASSED}}","  |  ",
"\\\\colorbox{myyellow}{WARNING}","  |  ",
"\\\\colorbox{myred}{\\\\textcolor{white}{FAILED}}"),
general_title = "Legend:",
footnote_as_chunk = T, escape = F)
View(assembly_qc_checked)
View(assembly_reco_df)
View(assembly_qc_result)
View(assembly_qc_value)
View(wgs_df)
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_html.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '_html.html', sep='')
)
}
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_ver2.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '.pdf', sep='')
)
}else{
cat("No file found")
}
View(assembly_qc_result)
View(bactscout_df_result)
View(bactscout_df_value)
View(df_bactscout_mod)
bactscout_df_result <- df_bactscout_mod %>%
select(name, species, Contamination = contamination_message,`Coverage (Qualibact)` = coverage_estimate_qualibact_status, `Duplication Rate` = duplication_status,
`GC Content` = gc_content_status, `MLST (ST)` = mlst_status, `Read Length` = read_length_status, `Read Q30` = read_q30_status, a_final_status)
bactscout_df_result <- df_bactscout_mod %>%
select(name, species, Contamination = contamination_message,`Coverage (Qualibact)` = coverage_estimate_qualibact_status, `Duplication Rate` = duplication_status,
`GC Content` = gc_content_status, `MLST (ST)` = mlst_status, `Read Length` = read_length_status, `Read Q30` = read_q30_status, a_final_status) %>%
mutate(Contamination = ifelse(Contamination != "OK", "PASSED", "FAILED"))
bactscout_df_result <- df_bactscout_mod %>%
select(name, species, Contamination = contamination_message,`Coverage (Qualibact)` = coverage_estimate_qualibact_status, `Duplication Rate` = duplication_status,
`GC Content` = gc_content_status, `MLST (ST)` = mlst_status, `Read Length` = read_length_status, `Read Q30` = read_q30_status, a_final_status) %>%
mutate(Contamination = ifelse(Contamination == "OK", "PASSED", "FAILED"))
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_html.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '_html.html', sep='')
)
}
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_ver2.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '.pdf', sep='')
)
}else{
cat("No file found")
}
View(assembly_failed)
assembly_failed <- assembly_qc_checked %>% filter(!is.na(failed_conditions))
if (nrow(assembly_failed) !=0) {
assembly_reco_df <- assembly_failed %>% select(sample_id, failed_conditions) %>%
mutate(sample_id = sub("(.*)_[^_]*$", "\\1", sample_id))
} else {
sample_id <- ""
failed_conditions <- "No further action required for this batch."
assembly_reco_df <- data.frame(sample_id,failed_conditions, remarks)
}
View(assembly_reco_df)
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_html.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '_html.html', sep='')
)
}
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_ver2.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '.pdf', sep='')
)
}else{
cat("No file found")
}
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_html.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '_html.html', sep='')
)
}
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_ver2.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '.pdf', sep='')
)
}else{
cat("No file found")
}
if(nrow(wgs_result_df) != 0){
rmarkdown::render("wgs_qc_report_ver2.Rmd",
output_file = paste("ARSRL_WGS_QC_report_",batch_code, '.pdf', sep='')
)
}else{
cat("No file found")
}
View(wgs_df)
gc()
